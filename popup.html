<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>红薯AI养号助手</title>
  <link rel="stylesheet" href="popup.css">
</head>
<body>

  <div class="container">

    <header class="header">
      <img src="icons/icon48.png" alt="logo" class="logo">
      <h1>红薯AI养号助手</h1>
      <a href="#" id="instruction-link" class="instruction-link">使用说明</a>
    </header>

    <main class="main-content">

      <!-- 卡片一：主控与状态 -->
      <section class="card">
        <div class="card-header">
          <h2>主控面板</h2>
        </div>
        <div class="card-content">
          <div class="control-grid">
            <div class="status-display">
              <span id="run-status-indicator" class="status-indicator offline"></span>
              <span id="run-status-text">已停止</span>
            </div>
            <div class="btn-group">
              <button id="start-btn" class="btn btn-primary">启动</button>
              <button id="stop-btn" class="btn btn-danger">停止</button>
            </div>
          </div>
        </div>
      </section>

      <!-- 卡片二：运行日志 -->
      <section class="card">
        <div class="card-header">
          <h2>运行日志</h2>
        </div>
        <div class="card-content">
          <pre id="run-log"></pre>
        </div>
      </section>

      <!-- 卡片三：授权管理 -->
      <section class="card">
        <div class="card-header">
          <h2>授权管理</h2>
        </div>
        <div class="card-content">
          <div class="form-group">
            <label for="license_key">授权码</label>
            <div class="input-group password-input-wrapper">
              <input type="password" id="license_key" placeholder="请输入您的授权码">
              <span class="toggle-password-visibility">👁️</span>
              <button id="save-license-btn" class="btn">验证</button>
            </div>
            <p id="license-status" class="status-text"></p>
          </div>
          <button id="get-license-btn" class="btn btn-secondary full-width">免费获取授权码？</button>
        </div>
      </section>

      <!-- 卡片四：核心配置 -->
      <section class="card">
        <div class="card-header">
          <h2>核心配置</h2>
        </div>
        <form id="config-form" class="card-content">
          <div class="form-group">
            <label for="keywords">关键词 (英文,逗号分隔)</label>
            <input type="text" id="keywords" name="keywords" placeholder="例如：旅游,穿搭,美食">
          </div>
          <div class="form-group">
            <label for="run_duration">运行时长 (分钟, 0为不限)</label>
            <input type="number" id="run_duration" name="run_duration" value="0" min="0">
          </div>
          <div class="form-group-row">
            <div class="checkbox-group">
              <input type="checkbox" id="search_mode" name="search_mode">
              <label for="search_mode">关键词搜索模式</label>
            </div>
            <div class="checkbox-group">
              <input type="checkbox" id="send_image" name="send_image" checked>
              <label for="send_image">发送图片给AI</label>
            </div>
          </div>
          <hr>
          <!-- AI / 本地模式切换 -->
          <div class="form-group-row">
            <div class="checkbox-group">
              <input type="checkbox" id="enable_ai_model" name="enable_ai_model" checked>
              <label for="enable_ai_model">启用大模型决策</label>
            </div>
          </div>

          <!-- AI 配置 -->
          <div id="ai-config-group">
            <div class="form-group">
              <label for="ai_base_url">AI API 地址</label>
              <input type="text" id="ai_base_url" name="ai_base_url" placeholder="https://api.openai.com/v1">
            </div>
            <div class="form-group">
              <label for="ai_api_key">AI API 密钥</label>
              <div class="password-input-wrapper">
                <input type="password" id="ai_api_key" name="ai_api_key" placeholder="sk-...">
                <span class="toggle-password-visibility">👁️</span>
              </div>
            </div>
            <div class="form-group">
              <label for="ai_model">AI 模型</label>
              <input type="text" id="ai_model" name="ai_model" placeholder="gpt-4-turbo">
            </div>
            <div class="form-group">
              <label for="prompt">AI 系统提示词 (Prompt)</label>
              <textarea id="prompt" name="prompt" rows="6" placeholder="定义AI的人设和行为指令..."></textarea>
            </div>
          </div>

          <!-- 本地策略配置 -->
          <div id="local-strategy-group" style="display: none;">
            <div class="form-group">
              <label for="like_probability">点赞概率: <span id="like_probability_value">50</span>%</label>
              <input type="range" id="like_probability" name="like_probability" min="0" max="100" value="50" class="slider">
            </div>
            <div class="form-group">
              <label for="fav_probability">收藏概率: <span id="fav_probability_value">10</span>%</label>
              <input type="range" id="fav_probability" name="fav_probability" min="0" max="100" value="10" class="slider">
            </div>
            <div class="form-group">
              <label for="comment_probability">评论概率: <span id="comment_probability_value">20</span>%</label>
              <input type="range" id="comment_probability" name="comment_probability" min="0" max="100" value="20" class="slider">
            </div>
            <div class="form-group">
              <label for="local_comments">自定义评论 (每行一条，随机选)</label>
              <textarea id="local_comments" name="local_comments" rows="4" placeholder="看着很好吃，去哪里买的呢"></textarea>
            </div>
          </div>
        </form>
      </section>

    </main>

  </div>

  <!-- 信息亭 Modal -->
  <div id="info-modal" class="modal-overlay" style="display: none;">
    <div class="modal-content">
      <span id="modal-close-btn" class="modal-close-btn">&times;</span>
      <h2>每天更新网盘自取</h2>
      <p>授权码</p>
      <div id="copy-content-area" class="copy-content-area"></div>
      <p class="copy-hint">按下 "C" 键可快速复制</p>
      <div id="copy-feedback" class="copy-feedback"></div>
    </div>
  </div>

  <script src="popup.js"></script>
</body>
</html>
